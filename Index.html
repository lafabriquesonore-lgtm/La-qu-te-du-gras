<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ğŸ® Le jeu oÃ¹ je reprends le contrÃ´le</title>

<style>
:root{
 --bg:#f5f5f7;--card:#fff;--text:#111;--muted:#666;
 --accent:#007aff;--bonus:#ff9500;
}
@media (prefers-color-scheme: dark){
 :root{
  --bg:#0f0f12;--card:#1c1c1e;--text:#f2f2f7;
  --muted:#9a9aa0;--accent:#0a84ff;--bonus:#ff9f0a;
 }
}
body{
 font-family:-apple-system,BlinkMacSystemFont,sans-serif;
 background:var(--bg);color:var(--text);
 margin:0;padding:20px;
}
h1{text-align:center;margin-bottom:4px;}
.score{font-size:46px;text-align:center;}
.next{text-align:center;color:var(--muted);margin-bottom:16px;}

.section{
 background:var(--card);
 padding:15px;border-radius:16px;
 margin-bottom:16px;
 box-shadow:0 6px 20px rgba(0,0,0,.05);
}

button{
 width:100%;padding:14px;margin:6px 0;
 font-size:16px;border:none;border-radius:14px;
 background:var(--accent);color:white;
}

.bonusBtn{background:var(--bonus);}
.done{background:#34c759!important}

.float{
 position:fixed;left:50%;top:40%;
 transform:translateX(-50%);
 font-size:26px;
 animation:float 1s ease-out;
 pointer-events:none;
}
@keyframes float{
 from{opacity:1;transform:translate(-50%,0)}
 to{opacity:0;transform:translate(-50%,-40px)}
}

.trophies{
 background:var(--card);
 padding:15px;border-radius:16px;
}
.trophy{opacity:.35}
.trophy.unlocked{opacity:1}
</style>
</head>

<body>

<h1>ğŸ® Le jeu oÃ¹ je reprends le contrÃ´le</h1>
<div class="score" id="score">0 pts</div>
<div class="next" id="next"></div>

<div class="section">
<h2>ğŸ² DÃ©fi du jour</h2>
<div id="dailyText"></div>
<button onclick="completeDaily()">Valider le dÃ©fi</button>
</div>

<div class="section">
<h2>ğŸ DÃ©fi bonus du jour</h2>
<div id="bonusText">Le bonus apparaÃ®tra Ã  8h</div>
<button id="bonusBtn" class="bonusBtn" style="display:none" onclick="completeBonus()">Valider le bonus</button>
</div>

<div class="section">
<h2>ğŸŸ¦ Mouvement</h2>
<button onclick="add(3)">Marche 30 min (+3)</button>
<button onclick="add(10)">10 000 pas (+10)</button>
<button onclick="add(20)">15 000 pas (+20)</button>
<button onclick="add(30)">20 000 pas (+30)</button>
</div>

<div class="section">
<h2>ğŸŸ© Alimentation</h2>
<button onclick="add(5)">Pas de junk food (+5)</button>
<button onclick="add(5)">Pas de sucrerie (+5)</button>
<button onclick="add(10)">Jâ€™ai cuisinÃ© moi-mÃªme (+10)</button>
<button onclick="add(15)">Je ne me suis pas resservi 2 fois (+15)</button>
</div>

<div class="section">
<h2>ğŸŸ¨ Rythme</h2>
<button onclick="add(5)">Heures de repas respectÃ©es (+5)</button>
<button onclick="add(5)">Dernier repas raisonnable (+5)</button>
<button onclick="add(5)">Sommeil correct (+5)</button>
<button onclick="add(10)">JournÃ©e structurÃ©e (+10)</button>
</div>

<div class="section">
<h2>ğŸŸ¥ Mental</h2>
<button onclick="add(5)">Pas mangÃ© sous stress (+5)</button>
<button onclick="add(10)">Jâ€™ai dit non Ã  une tentation (+10)</button>
<button onclick="add(10)">ArrÃªtÃ© Ã  satiÃ©tÃ© (+10)</button>
<button onclick="add(15)">Tenu malgrÃ© la flemme (+15)</button>
</div>

<div class="trophies">
<h2>ğŸ† TrophÃ©es</h2>
<div id="trophies"></div>
</div>

<script>
// --------- DÃ‰FIS DU JOUR ----------
const dailyChallenges=[
 {text:"Marcher au moins 20 minutes",pts:10},
 {text:"Aucun sucre ajoutÃ© aujourdâ€™hui",pts:10},
 {text:"Repas du soir simple et lÃ©ger",pts:10},
 {text:"Manger sans Ã©cran",pts:10},
 {text:"Tenir malgrÃ© la flemme",pts:15}
];

// --------- BONUS ----------
const bonusChallenges=[
 "Marcher sans musique","Boire un grand verre dâ€™eau avant de manger",
 "Ranger un seul endroit prÃ©cis","Manger assis, vraiment",
 "5 minutes dâ€™Ã©tirements","Sortir prendre lâ€™air 5 minutes",
 "Dire non sans se justifier","Laisser volontairement une assiette incomplÃ¨te",
 "Manger plus lentement que dâ€™habitude","Pause sans Ã©cran",
 "Marcher aprÃ¨s le repas","Se lever dÃ¨s le rÃ©veil",
 "Pas de grignotage","Respirer profondÃ©ment 2 minutes",
 "Choisir le plus simple","Sâ€™arrÃªter avant dâ€™Ãªtre plein",
 "Faire un choix calme","Se coucher 15 minutes plus tÃ´t",
 "Ne rien ajouter pour le plaisir","PrÃ©parer quelque chose pour demain"
];

// --------- TROPHÃ‰ES JUSQUâ€™Ã€ 10 000 ----------
const trophies=[
 {pts:100,   name:"Bonâ€¦ jâ€™ai commencÃ©."},
 {pts:300,   name:"Toujours pas mort."},
 {pts:600,   name:"Ok, câ€™est sÃ©rieux."},
 {pts:1000,  name:"Discipline > motivation."},
 {pts:2000,  name:"Machine lancÃ©e."},
 {pts:3000,  name:"Je fais Ã§a sans nÃ©gocier."},
 {pts:4000,  name:"Le corps commence Ã  suivre."},
 {pts:5000,  name:"Nouvelle norme installÃ©e."},
 {pts:6500,  name:"Avant / aprÃ¨s visible."},
 {pts:8000,  name:"Je me fais confiance."},
 {pts:10000, name:"Je nâ€™ai plus besoin du jeu. (mais je le garde)"}
];

// --------- Ã‰TAT ----------
let score=Number(localStorage.getItem("score_v4"))||0;
const today=new Date().toISOString().slice(0,10);

// DÃ©fi du jour
const daily=JSON.parse(localStorage.getItem("daily_"+today))
 || dailyChallenges[Math.floor(Math.random()*dailyChallenges.length)];
localStorage.setItem("daily_"+today,JSON.stringify(daily));
document.getElementById("dailyText").textContent=daily.text+" (+"+daily.pts+" pts)";

// Bonus Ã  8h
const now=new Date();
const eight=new Date(); eight.setHours(8,0,0,0);
let bonus=localStorage.getItem("bonus_"+today);
if(!bonus && now>=eight){
 bonus=bonusChallenges[Math.floor(Math.random()*bonusChallenges.length)];
 localStorage.setItem("bonus_"+today,bonus);
}
if(bonus){
 document.getElementById("bonusText").textContent=bonus+" (+20 pts)";
 document.getElementById("bonusBtn").style.display="block";
}

// --------- ACTIONS ----------
function completeDaily(){ add(daily.pts); }
function completeBonus(){ add(20); }

function add(p){
 score+=p;
 localStorage.setItem("score_v4",score);
 float("+"+p);
 render();
}

function float(t){
 const d=document.createElement("div");
 d.className="float"; d.textContent=t;
 document.body.appendChild(d);
 setTimeout(()=>d.remove(),1000);
}

// --------- AFFICHAGE ----------
function render(){
 document.getElementById("score").textContent=score+" pts";

 const next=trophies.find(t=>t.pts>score);
 document.getElementById("next").textContent=
  next?"Prochain trophÃ©e : "+next.pts+" pts":"Tous les trophÃ©es dÃ©bloquÃ©s";

 const list=document.getElementById("trophies");
 list.innerHTML="";

 trophies.forEach((t,i)=>{
  const prev=trophies[i-1];
  if(score>=t.pts || (!prev || score>=prev.pts)){
   const d=document.createElement("div");
   d.className="trophy"+(score>=t.pts?" unlocked":"");
   d.textContent=(score>=t.pts?"ğŸ† ":"ğŸ”’ ")+t.name+" ("+t.pts+" pts)";
   list.appendChild(d);
  }
 });
}

render();
</script>

</body>
</html>